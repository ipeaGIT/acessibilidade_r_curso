<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>4  GTFS data – Introduction to urban accessibility</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script><script src="site_libs/quarto-nav/headroom.min.js"></script><script src="site_libs/clipboard/clipboard.min.js"></script><script src="site_libs/quarto-search/autocomplete.umd.js"></script><script src="site_libs/quarto-search/fuse.min.js"></script><script src="site_libs/quarto-search/quarto-search.js"></script><meta name="quarto:offset" content="./">
<link href="./5_gtfstools.en.html" rel="next">
<link href="./s3_dados_tp.en.html" rel="prev">
<link href="./images/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script><script src="site_libs/quarto-html/popper.min.js"></script><script src="site_libs/quarto-html/tippy.umd.min.js"></script><script src="site_libs/quarto-html/anchor.min.js"></script><link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script><link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-YVERJQF9PJ"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-YVERJQF9PJ', { 'anonymize_ip': true});
</script><meta property="og:title" content="4  GTFS data – Introduction to urban accessibility">
<meta property="og:description" content="">
<meta property="og:site_name" content="Introduction to urban accessibility">
<meta name="twitter:title" content="4  GTFS data – Introduction to urban accessibility">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
<meta name="citation_title" content="Introduction to urban accessibility: a practical guide with R">
<meta name="citation_author" content="Rafael H. M. Pereira">
<meta name="citation_author" content="Daniel Herszenhut">
<meta name="citation_publication_date" content="2023">
<meta name="citation_cover_date" content="2023">
<meta name="citation_year" content="2023">
<meta name="citation_fulltext_html_url" content="https://ipeagit.github.io/intro_access_book">
<meta name="citation_pdf_url" content="https://repositorio.ipea.gov.br/bitstream/11058/12264/51/Introducao_a_acessibilidade_urbana_selo.pdf">
<meta name="citation_doi" content="http://dx.doi.org/10.38116/9786556350547">
<meta name="citation_isbn" content="978-65-5635-054-7">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Transport modelling in the age of big data;,citation_author=Cuauhtemoc Anda;,citation_author=Alexander Erath;,citation_author=Pieter Jacobus Fourie;,citation_publication_date=2017-08;,citation_cover_date=2017-08;,citation_year=2017;,citation_issue=sup1;,citation_doi=10.1080/12265934.2017.1281150;,citation_issn=1226-5934;,citation_volume=21;,citation_journal_title=International Journal of Urban Sciences;,citation_publisher=Routledge;">
<meta name="citation_reference" content="citation_title=Estimating the influence of crowding and travel time variability on accessibility to jobs in a large public transport network using smart card big data;,citation_author=Renato Arbex;,citation_author=Claudio B. Cunha;,citation_publication_date=2020-05;,citation_cover_date=2020-05;,citation_year=2020;,citation_doi=10.1016/j.jtrangeo.2020.102671;,citation_issn=09666923;,citation_volume=85;,citation_language=en-US;,citation_journal_title=Journal of Transport Geography;">
<meta name="citation_reference" content="citation_title=The sustainable mobility paradigm;,citation_author=David Banister;,citation_publication_date=2008-03;,citation_cover_date=2008-03;,citation_year=2008;,citation_issue=2;,citation_doi=10.1016/j.tranpol.2007.10.005;,citation_issn=0967070X;,citation_volume=15;,citation_language=en-US;,citation_journal_title=Transport Policy;">
<meta name="citation_reference" content="citation_title=The trilogy of distance, speed and time;,citation_author=David Banister;,citation_publication_date=2011-07;,citation_cover_date=2011-07;,citation_year=2011;,citation_issue=4;,citation_doi=10.1016/j.jtrangeo.2010.12.004;,citation_issn=09666923;,citation_volume=19;,citation_language=en-US;,citation_journal_title=Journal of Transport Geography;">
<meta name="citation_reference" content="citation_title=The world’s user-generated road map is more than 80% complete;,citation_abstract=OpenStreetMap, a crowdsourced geographic database, provides the only global-level, openly licensed source of geospatial road data, and the only national-level source in many countries. However, researchers, policy makers, and citizens who want to make use of OpenStreetMap (OSM) have little information about whether it can be relied upon in a particular geographic setting. In this paper, we use two complementary, independent methods to assess the completeness of OSM road data in each country in the world. First, we undertake a visual assessment of OSM data against satellite imagery, which provides the input for estimates based on a multilevel regression and poststratification model. Second, we fit sigmoid curves to the cumulative length of contributions, and use them to estimate the saturation level for each country. Both techniques may have more general use for assessing the development and saturation of crowd-sourced data. Our results show that in many places, researchers and policymakers can rely on the completeness of OSM, or will soon be able to do so. We find (i) that globally, OSM is $\sim$83% complete, and more than 40% of countriesincluding several in the developing worldhave a fully mapped street network; (ii) that well-governed countries with good Internet access tend to be more complete, and that completeness has a U-shaped relationship with population densityboth sparsely populated areas and dense cities are the best mapped; and (iii) that existing global datasets used by the World Bank undercount roads by more than 30%.;,citation_author=Christopher Barrington-Leigh;,citation_author=Adam Millard-Ball;,citation_publication_date=2017-08;,citation_cover_date=2017-08;,citation_year=2017;,citation_issue=8;,citation_doi=10.1371/journal.pone.0180698;,citation_issn=1932-6203;,citation_volume=12;,citation_language=en-US;,citation_journal_title=PLOS ONE;,citation_publisher=Public Library of Science;">
<meta name="citation_reference" content="citation_title=Sustainable accessibility: A conceptual framework to integrate transport and land use plan-making. Two test-applications in the Netherlands and a reflection on the way forward;,citation_author=L. Bertolini;,citation_author=F. Clercq;,citation_author=L. Kapoen;,citation_publication_date=2005-05;,citation_cover_date=2005-05;,citation_year=2005;,citation_issue=3;,citation_doi=10.1016/j.tranpol.2005.01.006;,citation_issn=0967070X;,citation_volume=12;,citation_language=en-US;,citation_journal_title=Transport Policy;">
<meta name="citation_reference" content="citation_title=How to get there? A critical assessment of accessibility objectives and indicators in metropolitan transportation plans;,citation_author=Geneviève Boisjoly;,citation_author=Ahmed M. El-Geneidy;,citation_publication_date=2017-04;,citation_cover_date=2017-04;,citation_year=2017;,citation_doi=10.1016/j.tranpol.2016.12.011;,citation_issn=0967070X;,citation_volume=55;,citation_language=en-US;,citation_journal_title=Transport Policy;">
<meta name="citation_reference" content="citation_title=Impactos da expansão do metrô de Fortaleza sobre o acesso a oportunidades de emprego, saúde e educação;,citation_author=Carlos Kaue Vieira Braga;,citation_author=Diego Bogado Tomasiello;,citation_author=Daniel Herszenhut;,citation_author=João Lucas Albuquerque Oliveira;,citation_author=Rafael H. M. Pereira;,citation_publication_date=2022-05;,citation_cover_date=2022-05;,citation_year=2022;,citation_language=pt-BR;,citation_technical_report_institution=Instituto de Pesquisa Econômica Aplicada (Ipea);,citation_technical_report_number=2767;">
<meta name="citation_reference" content="citation_title=H3: Uber’s Hexagonal Hierarchical Spatial Index;,citation_author=Isaac Brodsky;,citation_publication_date=2018-06;,citation_cover_date=2018-06;,citation_year=2018;,citation_language=en-US;,citation_journal_title=Uber Engineering Blog;,citation_publisher=https://eng.uber.com/h3/;">
<meta name="citation_reference" content="citation_title=More than just a bus trip: School busing, disability and access to education in Toronto, Canada;,citation_abstract=Children with disabilities in Ontario, Canada have their right to equal access to education protected by the 1990 Ontario Human Rights Code and the 1990 Education Act. These legislated rights require the delivery of stigma- and barrier-free education services to children with disabilities. However, the extent to which compliance is achieved by school boards and individual schools is questionable and warrants attention as a matter of both scholarship and public policy. In this paper, we take up and apply the concept of excess travel (i.e., the travel beyond what would be required given a more optimal distribution of housing and schools) to examine the extent to which students with disability and their families are required to undertake longer, more time-consuming school trips. Our analysis includes students who were bused to TDSB elementary (grade school) and secondary (high school) schools. We use TDSB student busing records for the 2016 school year obtained in collaboration with the TDSB between December 2017 and March 2018. Our findings indicate substantial excess travel, particularly for students who are labelled as deaf, physically disabled, or having a behavioural exceptionality. Excess travel time experienced by students with disability is concerning given that it can lead to missed classroom time and may limit opportunities for peer interaction. The availability of busing services for students with disability confers access to education, yet it may paradoxically produce disabling experiences.;,citation_author=Ron Buliung;,citation_author=Patrick Bilas;,citation_author=Timothy Ross;,citation_author=Cosmin Marmureanu;,citation_author=Ahmed El-Geneidy;,citation_publication_date=2021-06;,citation_cover_date=2021-06;,citation_year=2021;,citation_doi=10.1016/j.tra.2021.04.005;,citation_issn=0965-8564;,citation_volume=148;,citation_language=en-US;,citation_journal_title=Transportation Research Part A: Policy and Practice;">
<meta name="citation_reference" content="citation_title=Accessibility Tools for Transport Policy and Planning;,citation_author=Benjamin Büttner;,citation_editor=Roger Vickerman;,citation_publication_date=2021-01;,citation_cover_date=2021-01;,citation_year=2021;,citation_doi=10.1016/B978-0-08-102671-7.10618-9;,citation_isbn=978-0-08-102672-4;,citation_language=en-US;,citation_inbook_title=International Encyclopedia of Transportation;">
<meta name="citation_reference" content="citation_title=An Investigation into the Completeness of, and the Updates to, OpenStreetMap Data in a Heterogeneous Area in Brazil;,citation_abstract=The integration of user-generated content made in a collaborative environment is being increasingly considered a valuable input to reference maps, even from official map agencies such as USGS and Ordnance Survey. In Brazil, decades of lack of investment has resulted in a topographic map coverage that is both outdated and unequally distributed throughout the territory. This paper aims to analyze the spatial distribution of updates of OpenStreetMap in rural and urban areas in the country to understand the patterns of user updates and its correlation with other economic and developmental variables. This analysis will contribute to generating the knowledge needed in order to consider the use of this data as part of a reference layer of the National Spatial Database Infrastructure as well to design strategies to encourage user action in specific areas.;,citation_author=Silvana Philippi Camboim;,citation_author=João Vitor Meza Bravo;,citation_author=Claudia Robbi Sluter;,citation_publication_date=2015-09;,citation_cover_date=2015-09;,citation_year=2015;,citation_issue=3;,citation_doi=10.3390/ijgi4031366;,citation_issn=2220-9964;,citation_volume=4;,citation_language=en-US;,citation_journal_title=ISPRS International Journal of Geo-Information;,citation_publisher=Multidisciplinary Digital Publishing Institute;">
<meta name="citation_reference" content="citation_title=Accessible Cities and Regions: A Framework for Sustainable Transport and Urbanism in the 21st Century;,citation_author=Robert Cervero;,citation_publication_date=2005-08;,citation_cover_date=2005-08;,citation_year=2005;,citation_issue=UCB-ITS-VWP-2005-3;,citation_journal_title=Center for Future Urban Transport Working Paper;">
<meta name="citation_reference" content="citation_title=Transport and social exclusion in London;,citation_author=A Church;,citation_author=M Frost;,citation_author=K Sullivan;,citation_publication_date=2000-07;,citation_cover_date=2000-07;,citation_year=2000;,citation_issue=3;,citation_doi=10.1016/S0967-070X(00)00024-X;,citation_issn=0967070X;,citation_volume=7;,citation_language=en-US;,citation_journal_title=Transport Policy;">
<meta name="citation_reference" content="citation_title=Evidence-Based Transit and Land Use Sketch Planning Using Interactive Accessibility Methods on Combined Schedule and Headway-Based Networks;,citation_author=Matthew Wigginton Conway;,citation_author=Andrew Byrd;,citation_author=Marco Linden;,citation_publication_date=2017-01;,citation_cover_date=2017-01;,citation_year=2017;,citation_issue=1;,citation_doi=10.3141/2653-06;,citation_issn=0361-1981, 2169-4052;,citation_volume=2653;,citation_language=en-US;,citation_journal_title=Transportation Research Record: Journal of the Transportation Research Board;">
<meta name="citation_reference" content="citation_title=Opportunities for Transport Mode Change: An Exploration of a Disaggregated Approach;,citation_author=Martin Dijst;,citation_author=Tom Jong;,citation_author=Jan Ritsema Eck;,citation_publication_date=2002-06;,citation_cover_date=2002-06;,citation_year=2002;,citation_issue=3;,citation_doi=10.1068/b12811;,citation_issn=0265-8135, 1472-3417;,citation_volume=29;,citation_language=en-US;,citation_journal_title=Environment and Planning B: Planning and Design;">
<meta name="citation_reference" content="citation_title=Moving from trip-based to activity-based measures of accessibility;,citation_author=Xiaojing Dong;,citation_author=Moshe E. Ben-Akiva;,citation_author=John L. Bowman;,citation_author=Joan L. Walker;,citation_publication_date=2006-02;,citation_cover_date=2006-02;,citation_year=2006;,citation_issue=2;,citation_doi=10.1016/j.tra.2005.05.002;,citation_issn=09658564;,citation_volume=40;,citation_language=en-US;,citation_journal_title=Transportation Research Part A: Policy and Practice;">
<meta name="citation_reference" content="citation_title=The cost of equity: Assessing transit accessibility and social disparity using total travel cost;,citation_author=Ahmed El-Geneidy;,citation_author=David Levinson;,citation_author=Ehab Diab;,citation_author=Genevieve Boisjoly;,citation_author=David Verbich;,citation_author=Charis Loong;,citation_publication_date=2016-09;,citation_cover_date=2016-09;,citation_year=2016;,citation_doi=10.1016/j.tra.2016.07.003;,citation_issn=09658564;,citation_volume=91;,citation_language=en-US;,citation_journal_title=Transportation Research Part A: Policy and Practice;">
<meta name="citation_reference" content="citation_title=Rural accessibility, social inclusion and social justice: Towards conceptualisation;,citation_author=John Farrington;,citation_author=Conor Farrington;,citation_publication_date=2005-03;,citation_cover_date=2005-03;,citation_year=2005;,citation_issue=1;,citation_doi=10.1016/j.jtrangeo.2004.10.002;,citation_issn=09666923;,citation_volume=13;,citation_language=en-US;,citation_journal_title=Journal of Transport Geography;">
<meta name="citation_reference" content="citation_title=Accessibility evaluation of land-use and transport strategies: Review and research directions;,citation_author=Karst Geurs;,citation_author=Bert Wee;,citation_publication_date=2004-06;,citation_cover_date=2004-06;,citation_year=2004;,citation_issue=2;,citation_doi=10.1016/j.jtrangeo.2003.10.005;,citation_issn=09666923;,citation_volume=12;,citation_language=en-US;,citation_journal_title=Journal of Transport Geography;">
<meta name="citation_reference" content="citation_title=Elevating access: Comparing accessibility to jobs by public transport for individuals with and without a physical disability;,citation_abstract=Equal access to opportunities has emerged in public transport planning as a social objective that many transport agencies are trying to achieve. Yet in practice, not all public transport agencies are currently providing urban residents with comparable levels of service due to physical barriers in the public transport network that can significantly hinder the ability of individuals with physical disabilities to access opportunities. In countries without a strong federal accessibility act and/or with major financial constraints, some public transport agencies fall behind in applying universal access design principles, making it even harder for people with a physical disability to access opportunities. The objective of this study is to develop a methodology that can be used by public transport agencies or disability advocates to clearly highlight and quantify the performance of the public transport network in a region, in terms of providing transit services to people in a wheelchair and compare that to the service offered to an individual not in a wheelchair. In this study we use accessibility, the ease of reaching destinations, by public transport as the key performance measure in two major Canadian Cities (Montreal and Toronto). Furthermore, we focus on job accessibility in the most socially vulnerable census tracts in both cities, to evaluate levels of job accessibility for wheelchair users residing in socially vulnerable areas. The findings from our study show striking contrasts between the numbers of accessible jobs by public transport for wheelchair users compared to the general population. On average, wheelchair users in Toronto have access to 75% of jobs that are accessible to users that are not in a wheelchair, whilst their counterparts in Montreal have access to only 46% of the jobs accessible to other users. This research is expected to highlight for public transport engineers, planners, policy makers and advocates for those with disabilities, the importance of universal access in a region, especially along public transport networks, using a widely used land use and transport performance measure.;,citation_author=Emily Grisé;,citation_author=Geneviève Boisjoly;,citation_author=Meadhbh Maguire;,citation_author=Ahmed El-Geneidy;,citation_publication_date=2019-07;,citation_cover_date=2019-07;,citation_year=2019;,citation_doi=10.1016/j.tra.2018.02.017;,citation_issn=0965-8564;,citation_volume=125;,citation_language=en-US;,citation_journal_title=Transportation Research Part A: Policy and Practice;">
<meta name="citation_reference" content="citation_title=Accessibility, affordability and equity: Assessing “pro-poor” public transport subsidies in Bogotá;,citation_abstract=Public transport has claimed a preferential position in recent urban development agendas internationally. Rising interest on inclusive development of cities at different levels of urban policy involves new opportunities and challenges for increasingly urban societies. In cities of the Global South, in addition to institutional and physical challenges for the development of efficient and inclusive public transport, local governments face the challenge of making public transport affordable for a large share of the population in conditions of poverty. In order to meet these challenges, several public transport systems throughout have implemented targeted subsidies for specific social groups such as students, the elderly and people with reduced mobility, and more recently for the poor. The government of Bogotá has implemented a pro-poor public transport subsidy scheme that aims at alleviating the financial burden of poor households for accessing the city’s public transport system. This research develops an analysis of the effects of such subsidy from an accessibility perspective using potential accessibility measures to employment opportunities and assess its impact on equity. The research builds on the hypothesis that accessibility is a multi-dimensional construct that can benefit from the decrease in economic as much as gains in time costs. Results from the analysis show that both the current structure of the pro-poor subsidies in Bogotá and alternative scenarios for increasing its coverage are progressive, improving accessibility and equity for those with access to the subsidy. The paper provides valuable insights for the analysis of similar policies in other urban contexts in the Global South.;,citation_author=Luis A. Guzman;,citation_author=Daniel Oviedo;,citation_publication_date=2018-09;,citation_cover_date=2018-09;,citation_year=2018;,citation_doi=10.1016/j.tranpol.2018.04.012;,citation_issn=0967-070X;,citation_volume=68;,citation_language=en-US;,citation_journal_title=Transport Policy;">
<meta name="citation_reference" content="citation_title=Gtfstools: General Transit Feed Specification (GTFS) Editing and Analysing Tools;,citation_author=Daniel Herszenhut;,citation_author=Rafael H. M. Pereira;,citation_author=Pedro R. Andrade;,citation_author=João Bazzo;,citation_publication_date=2022-05;,citation_cover_date=2022-05;,citation_year=2022;,citation_doi=10.5281/ZENODO.6577028;,citation_language=en-US;,citation_publisher=Zenodo;">
<meta name="citation_reference" content="citation_title=The impact of transit monetary costs on transport inequality;,citation_author=Daniel Herszenhut;,citation_author=Rafael H. M. Pereira;,citation_author=Licinio da Silva Portugal;,citation_author=Matheus Henrique de Sousa Oliveira;,citation_publication_date=2022-02;,citation_cover_date=2022-02;,citation_year=2022;,citation_doi=10.1016/j.jtrangeo.2022.103309;,citation_issn=09666923;,citation_volume=99;,citation_language=en-US;,citation_journal_title=Journal of Transport Geography;">
<meta name="citation_reference" content="citation_title=Calculating place-based transit accessibility: Methods, tools and algorithmic dependence;,citation_author=Christopher Higgins;,citation_author=Matthew Palm;,citation_author=Amber DeJohn;,citation_author=Luna Xi;,citation_author=James Vaughan;,citation_author=Steven Farber;,citation_author=Michael Widener;,citation_author=Eric Miller;,citation_publication_date=2022-02;,citation_cover_date=2022-02;,citation_year=2022;,citation_issue=1;,citation_doi=10.5198/jtlu.2022.2012;,citation_issn=1938-7849;,citation_volume=15;,citation_journal_title=Journal of Transport and Land Use;">
<meta name="citation_reference" content="citation_title=Smart cities, big data and urban policy: Towards urban analytics for the long run;,citation_author=Jens Kandt;,citation_author=Michael Batty;,citation_publication_date=2021-02;,citation_cover_date=2021-02;,citation_year=2021;,citation_doi=10.1016/j.cities.2020.102992;,citation_issn=0264-2751;,citation_volume=109;,citation_language=en-US;,citation_journal_title=Cities;">
<meta name="citation_reference" content="citation_title=Space-time accessibility measures: A geocomputational algorithm with a focus on the feasible opportunity set and possible activity duration;,citation_author=Hyun-Mi Kim;,citation_author=Mei-Po Kwan;,citation_publication_date=2003-05;,citation_cover_date=2003-05;,citation_year=2003;,citation_issue=1;,citation_doi=10.1007/s101090300104;,citation_issn=1435-5930, 1435-5949;,citation_volume=5;,citation_journal_title=Journal of Geographical Systems;">
<meta name="citation_reference" content="citation_title=From mobility to accessibility: Transforming urban transportation and land-use planning;,citation_author=Jonathan Levine;,citation_author=Joe Grengs;,citation_author=Louis A. Merlin;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;">
<meta name="citation_reference" content="citation_title=Towards a general theory of access;,citation_author=David M. Levinson;,citation_author=Hao Wu;,citation_publication_date=2020-06;,citation_cover_date=2020-06;,citation_year=2020;,citation_issue=1;,citation_doi=10.5198/jtlu.2020.1660;,citation_issn=1938-7849;,citation_volume=13;,citation_language=en-US;,citation_journal_title=Journal of Transport and Land Use;">
<meta name="citation_reference" content="citation_title=Transport access manual: A guide for measuring connection between people and places;,citation_author=David Levinson;,citation_author=David King;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;">
<meta name="citation_reference" content="citation_title=A method to evaluate equitable accessibility: Combining ethical theories and accessibility-based approaches;,citation_abstract=In this paper, we present the case that traditional transport appraisal methods do not sufficiently capture the social dimensions of mobility and accessibility. However, understanding this is highly relevant for policymakers to understand the impacts of their transport decisions. These dimensions include the distribution of mobility and accessibility levels over particular areas or for specific population groups, as well as how this may affect various social outcomes, including their levels of participation, social inclusion and community cohesion. In response, we propose a method to assess the socially relevant accessibility impacts (SRAIs) of policies in some of these key dimensions. The method combines the use of underlying ethics principles, more specifically the theories of egalitarianism and sufficientarianism, in combination with accessibility-based analysis and the Lorenz curve and Gini index. We then demonstrate the method in a case study example. Our suggestion is that policymakers can use these ethical perspectives to determine the equity of their policies decisions and to set minimum standards for local transport delivery. This will help them to become more confident in the development and adoption of new decision frameworks that promote accessibility over mobility and which also disaggregate the costs and benefits of transport policies over particular areas or for specific under-served population groups.;,citation_author=Karen Lucas;,citation_author=Bert Wee;,citation_author=Kees Maat;,citation_publication_date=2016-05;,citation_cover_date=2016-05;,citation_year=2016;,citation_issue=3;,citation_doi=10.1007/s11116-015-9585-2;,citation_issn=1572-9435;,citation_volume=43;,citation_language=en-US;,citation_journal_title=Transportation;">
<meta name="citation_reference" content="citation_title=Transport poverty and its adverse social consequences;,citation_author=Karen Lucas;,citation_author=Giulio Mattioli;,citation_author=Ersilia Verlinghieri;,citation_author=Alvaro Guzman;,citation_publication_date=2016-12;,citation_cover_date=2016-12;,citation_year=2016;,citation_issue=6;,citation_doi=10.1680/jtran.15.00073;,citation_issn=0965-092X, 1751-7710;,citation_volume=169;,citation_language=en-US;,citation_journal_title=Proceedings of the Institution of Civil Engineers - Transport;">
<meta name="citation_reference" content="citation_title=Measures of Spatial Accessibility to Health Care in a GIS Environment: Synthesis and a Case Study in the Chicago Region;,citation_author=Wei Luo;,citation_author=Fahui Wang;,citation_publication_date=2003-12;,citation_cover_date=2003-12;,citation_year=2003;,citation_issue=6;,citation_doi=10.1068/b29120;,citation_issn=0265-8135, 1472-3417;,citation_volume=30;,citation_language=en-US;,citation_journal_title=Environment and Planning B: Planning and Design;,citation_publisher=SAGE Publications Sage UK: London, England;">
<meta name="citation_reference" content="citation_title=Understanding transport-related social exclusion through the lens of capabilities approach;,citation_author=Gregório Luz;,citation_author=Licinio Portugal;,citation_publication_date=2022-07;,citation_cover_date=2022-07;,citation_year=2022;,citation_issue=4;,citation_doi=10.1080/01441647.2021.2005183;,citation_issn=0144-1647;,citation_volume=42;,citation_journal_title=Transport Reviews;,citation_publisher=Routledge;">
<meta name="citation_reference" content="citation_title=Justice in transport as justice in accessibility: Applying Walzer’s “Spheres of Justice” to the transport sector;,citation_author=Karel Martens;,citation_publication_date=2012-11;,citation_cover_date=2012-11;,citation_year=2012;,citation_issue=6;,citation_doi=10.1007/s11116-012-9388-7;,citation_issn=0049-4488, 1572-9435;,citation_volume=39;,citation_language=en-US;,citation_journal_title=Transportation;">
<meta name="citation_reference" content="citation_title=Pioneering Open Data Standards: The GTFS Story;,citation_author=Bibiana McHugh;,citation_editor=Brett Goldstein;,citation_editor=Lauren Dyson;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_isbn=978-0-615-88908-5;,citation_inbook_title=Beyond Transparency: Open Data and the Future of Civic Innovation;">
<meta name="citation_reference" content="citation_title=Accessibility: Measurement and application in transportation planning;,citation_author=Eric J. Miller;,citation_publication_date=2018-09;,citation_cover_date=2018-09;,citation_year=2018;,citation_issue=5;,citation_doi=10.1080/01441647.2018.1492778;,citation_issn=0144-1647;,citation_volume=38;,citation_journal_title=Transport Reviews;,citation_publisher=Routledge;">
<meta name="citation_reference" content="citation_title=A utility-based travel impedance measure for public transit network accessibility;,citation_author=Neema Nassir;,citation_author=Mark Hickman;,citation_author=Ali Malekzadeh;,citation_author=Elnaz Irannezhad;,citation_publication_date=2016-06;,citation_cover_date=2016-06;,citation_year=2016;,citation_doi=10.1016/j.tra.2016.03.007;,citation_issn=09658564;,citation_volume=88;,citation_language=en-US;,citation_journal_title=Transportation Research Part A: Policy and Practice;">
<meta name="citation_reference" content="citation_title=Equity of Urban Service Delivery: A Comparison of Different Accessibility Measures;,citation_author=Tijs Neutens;,citation_author=Tim Schwanen;,citation_author=Frank Witlox;,citation_author=Philippe De Maeyer;,citation_publication_date=2010-07;,citation_cover_date=2010-07;,citation_year=2010;,citation_issue=7;,citation_doi=10.1068/a4230;,citation_issn=0308-518X, 1472-3409;,citation_volume=42;,citation_language=en-US;,citation_journal_title=Environment and Planning A: Economy and Space;">
<meta name="citation_reference" content="citation_title=An analysis of day-to-day variations in individual spacetime accessibility;,citation_author=Tijs Neutens;,citation_author=Matthias Delafontaine;,citation_author=Darren M. Scott;,citation_author=Philippe De Maeyer;,citation_publication_date=2012-07;,citation_cover_date=2012-07;,citation_year=2012;,citation_doi=10.1016/j.jtrangeo.2012.04.001;,citation_issn=0966-6923;,citation_volume=23;,citation_language=en-US;,citation_journal_title=Journal of Transport Geography;,citation_series_title=Special Issue on Time Geography;">
<meta name="citation_reference" content="citation_title=Measuring accessibility: Positive and normative implementations of various accessibility indicators;,citation_author=Antonio Páez;,citation_author=Darren M. Scott;,citation_author=Catherine Morency;,citation_publication_date=2012-11;,citation_cover_date=2012-11;,citation_year=2012;,citation_doi=10.1016/j.jtrangeo.2012.03.016;,citation_issn=09666923;,citation_volume=25;,citation_language=en-US;,citation_journal_title=Journal of Transport Geography;">
<meta name="citation_reference" content="citation_title=Demand and level of service inflation in Floating Catchment Area (FCA) methods;,citation_author=Antonio Paez;,citation_author=Christopher D. Higgins;,citation_author=Salvatore F. Vivona;,citation_editor=Tayyab Ikram Shah;,citation_publication_date=2019-06;,citation_cover_date=2019-06;,citation_year=2019;,citation_issue=6;,citation_doi=10.1371/journal.pone.0218773;,citation_issn=1932-6203;,citation_volume=14;,citation_language=en-US;,citation_journal_title=PLOS ONE;">
<meta name="citation_reference" content="citation_title=Accessibility instruments for planning practice: A review of European experiences;,citation_author=Enrica Papa;,citation_author=Cecilia Silva;,citation_author=Marco Te Brömmelstroet;,citation_author=Angela Hull;,citation_publication_date=2015-06;,citation_cover_date=2015-06;,citation_year=2015;,citation_doi=10.5198/jtlu.2015.585;,citation_issn=1938-7849;,citation_journal_title=Journal of Transport and Land Use;">
<meta name="citation_reference" content="citation_title=Distributive justice and equity in transportation;,citation_abstract=Over the past decades, transport researchers and policy-makers have devoted increasing attention to questions about justice and equity. Nonetheless, there is still little engagement with theories in political philosophy to frame what justice means in the context of transport policies. This paper reviews key theories of justice (utilitarianism, libertarianism, intuitionism, Rawls’ egalitarianism, and Capability Approaches (CAs)) and critically evaluates the insights they generate when applied to transport. Based on a combination of Rawlsian and CAs, we propose that distributive justice concerns over transport disadvantage and social exclusion should focus primarily on accessibility as a human capability. This means that, in policy evaluation, a detailed analysis of the distributional effects of transport policies should take account of the setting of minimum standards of accessibility to key destinations and the extent to which these policies respect individuals’ rights and prioritise disadvantaged groups, reduce inequalities of opportunities, and mitigate transport externalities. A full account of justice in transportation requires a more complete understanding of accessibility than traditional approaches have been able to deliver to date.;,citation_author=Rafael H. M. Pereira;,citation_author=Tim Schwanen;,citation_author=David Banister;,citation_publication_date=2017-03;,citation_cover_date=2017-03;,citation_year=2017;,citation_issue=2;,citation_doi=10.1080/01441647.2016.1257660;,citation_issn=0144-1647, 1464-5327;,citation_volume=37;,citation_language=en-US;,citation_journal_title=Transport Reviews;">
<meta name="citation_reference" content="citation_title=Desigualdades socioespaciais de acesso a oportunidades nas cidades brasileiras, 2019;,citation_author=Rafael H. M. Pereira;,citation_author=Carlos Kaue Vieira Braga;,citation_author=Bernardo Serra;,citation_author=Vanessa Nadalin;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_language=pt-PT;,citation_technical_report_institution=Instituto de Pesquisa Econômica Aplicada (Ipea);,citation_technical_report_number=2535;">
<meta name="citation_reference" content="citation_title=R5r: Rapid Realistic Routing on Multimodal Transport Networks with R&amp;amp;amp;lt;sup&amp;gt;5&amp;lt;/sup&amp;gt; in R;,citation_author=Rafael H. M. Pereira;,citation_author=Marcus Saraiva;,citation_author=Daniel Herszenhut;,citation_author=Carlos Kaue Vieira Braga;,citation_author=Matthew Wigginton Conway;,citation_publication_date=2021-03;,citation_cover_date=2021-03;,citation_year=2021;,citation_doi=10.32866/001c.21262;,citation_language=en-US;,citation_journal_title=Transport Findings;,citation_publisher=Network Design Lab;">
<meta name="citation_reference" content="citation_title=Transportation Equity;,citation_abstract=Transportation equity is a way to frame distributive justice concerns in relation to how social, economic, and government institutions shape the distribution of transportation benefits and burdens in society. It focuses on the evaluative standards used to judge the differential impacts of policies and plans, asking who benefits from and is burdened by them and to what extent. Questions of transportation equity involve both sufficientarian and egalitarian concerns with both absolute levels of wellbeing, transport-related poverty and social exclusion as well as with relative levels of transport-related inequalities. Ultimately, the study of transport equity explores the multiple channels through which transport and land use policies can create conditions for more inclusive cities and transport systems that allow different people to flourish, to satisfy their basic needs and lead a meaningful life. Transportation equity issues broadly encompass how policy decisions shape societal levels of environmental externalities and what groups are more or less exposed to them, as well as how those decisions affect the lives of different groups in terms of their ability to access life-enhancing opportunities such as employment, healthcare, and education. Equity is a crucial part of a broader concern with transport and mobility justice. The call for transport justice goes beyond distributive concerns, and yet justice cannot be achieved withoutequity.;,citation_author=Rafael H. M. Pereira;,citation_author=Alex Karner;,citation_editor=Roger Vickerman;,citation_publication_date=2021-01;,citation_cover_date=2021-01;,citation_year=2021;,citation_doi=10.1016/B978-0-08-102671-7.10053-3;,citation_isbn=978-0-08-102672-4;,citation_language=en-US;,citation_inbook_title=International Encyclopedia of Transportation;">
<meta name="citation_reference" content="citation_title=Accessibility: Transport Accessibility Measures;,citation_author=Rafael H. M. Pereira;,citation_author=Daniel Herszenhut;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;">
<meta name="citation_reference" content="citation_title=Aopdata: Data from the Access to Opportunities Project;,citation_author=Rafael H. M. Pereira;,citation_author=Daniel Herszenhut;,citation_author=Carlos K. V. Braga;,citation_author=Diego B. Tomasiello;,citation_author=Marcus Saraiva;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;">
<meta name="citation_reference" content="citation_title=Distribuição espacial de características sociodemográficas e localização de empregos e serviços públicos das vinte maiores cidades do Brasil;,citation_author=Rafael H. M. Pereira;,citation_author=Daniel Herszenhut;,citation_author=Carlos Kauê Vieira Braga;,citation_author=João Pedro Bazzo;,citation_author=João Lucas Albuquerque Oliveira;,citation_author=João Pedro Parga;,citation_author=Marcus Saraiva;,citation_author=Luiz Pedro Silva;,citation_author=Lucas Warwar;,citation_author=Diego Bogado Tomasiello;,citation_publication_date=2022-06;,citation_cover_date=2022-06;,citation_year=2022;,citation_doi=10.38116/td2772;,citation_issn=ISSN 1415-4765;,citation_volume=2772;,citation_language=pt-PT;,citation_journal_title=Texto para Discussão IPEA;,citation_publisher=Instituto de Pesquisa Econômica Aplicada (Ipea);">
<meta name="citation_reference" content="citation_title=Estimativas de acessibilidade a empregos e serviços públicos via transporte ativo, público e privado nas 20 maiores cidades do Brasil em 2017, 2018, 2019;,citation_author=Rafael H. M. Pereira;,citation_author=Carlos Kauê Vieira Braga;,citation_author=Daniel Herszenhut;,citation_author=Marcus Saraiva;,citation_author=Diego Bogado Tomasiello;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_volume=2800;,citation_language=pt-PT;,citation_journal_title=Texto para Discussão IPEA;,citation_publisher=Instituto de Pesquisa Econômica Aplicada (Ipea);">
<meta name="citation_reference" content="citation_title=Exploring the time geography of public transport networks with the Gtfs2gps package;,citation_abstract=The creation of the General Transit Feed Specification (GTFS) in the mid-2000s provided a new data format for cities to organize and share digital information on their public transport systems. GTFS feeds store geolocated data on public transport networks, including information on routes, stops, timetables, and service levels. The GTFS standard is now widely adopted by thousands of transport authorities and a wide variety of software applications for different purposes, including trip planning, timetable creation and accessibility analysis. Yet, there is still a lack of tools to parse GTFS data when the objective is to analyze the complex spatial and temporal patterns of public transport systems. This paper presents {gtfs2gps}, a new general-purpose computational tool to easily process static GTFS data that allows one to analyze the spacetime trajectories of public transport vehicles at fine spatial and temporal resolutions. {gtfs2gps} is an open-source R package that employs parallel computing to convert GTFS feeds from relational text files into a trajectory data table, similar to GPS records, with the timestamps of vehicles in every trip. This paper explains the package functionalities and demonstrates how {gtfs2gps} can be used to articulate key concepts in time geography to explore and visualize the spatial and temporal patterns of public transport networks. We also present a case study looking at how {gtfs2gps} can be used to examine socioeconomic and spatialtemporal inequalities in access to public transport, providing key information to monitor cities’ progress toward the Sustainable Development Goals. The paper is accompanied by a computational notebook in R Markdown to support reproducibility of the results in this paper and to replicate the analysis for other contexts where GTFS data are available. Given the widespread use of GTFS, {gtfs2gps} opens new possibilities for researchers to examine the time geography of public transport systems in urban areas across the globe.;,citation_author=Rafael H. M. Pereira;,citation_author=Pedro R. Andrade;,citation_author=João Pedro Bazzo Vieira;,citation_publication_date=2022-12;,citation_cover_date=2022-12;,citation_year=2022;,citation_doi=10.1007/s10109-022-00400-x;,citation_issn=1435-5949;,citation_language=en-US;,citation_journal_title=Journal of Geographical Systems;">
<meta name="citation_reference" content="citation_title=An International Comparison of Equity in Accessibility to Jobs: London, São Paulo and the Randstad;,citation_abstract=We analyze the impact of different accessibility measures on the interpretation of associated equity analysis using the Gini Coefficient and the (pseudo) Palma Ratio, and the impact of the method of assigning zonal accessibility on Gini estimation results using four different alternatives. Two types of potential accessibility measures (zonal and person-based) and two ratios of potential jobs to potential population (intra-modal and multi-modal) are estimated for car and transit in the Netherlands’ Randstad region, Greater London, and São Paulo relying on network data, schedule-based data, and speed profiles. Gini results are heavily influenced by the accessibility indicator and the method of assignment. The Palma ratio is also influenced by the choice of accessibility indicator, with the person-based potential accessibility measure tending to show greater inequity.;,citation_author=John P. Pritchard;,citation_author=Diego Tomasiello;,citation_author=Mariana Giannotti;,citation_author=Karst Geurs;,citation_publication_date=2019-02;,citation_cover_date=2019-02;,citation_year=2019;,citation_doi=10.32866/7412;,citation_language=en-US;,citation_journal_title=Findings;,citation_publisher=Findings Press;">
<meta name="citation_reference" content="citation_title=Transporte urbano e insuficiência de acesso a escolas no Brasil;,citation_author=Marcus Saraiva;,citation_author=Luiz Pedro Silva;,citation_author=Carlos Kauê Vieira Braga;,citation_author=Rafael Henrique Moraes Pereira;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_language=pt-PT;,citation_technical_report_institution=Instituto de Pesquisa Econômica Aplicada (Ipea);,citation_technical_report_number=2854;">
<meta name="citation_reference" content="citation_title=Accessibility instruments in planning practice: Bridging the implementation gap;,citation_author=Cecília Silva;,citation_author=Luca Bertolini;,citation_author=Marco Brömmelstroet;,citation_author=Dimitris Milakis;,citation_author=Enrica Papa;,citation_publication_date=2017-01;,citation_cover_date=2017-01;,citation_year=2017;,citation_doi=10.1016/j.tranpol.2016.09.006;,citation_issn=0967-070X;,citation_volume=53;,citation_language=en-US;,citation_journal_title=Transport Policy;">
<meta name="citation_reference" content="citation_title=Transport Modes and Accessibility;,citation_abstract=Accessibility by distinguished transport modes is probably the most important concept in transport geography and transport planning: it expresses that the transport system aims to provide access to places where people want to carry out activities. But it is also a concept for which many definitions and indicators are available, each characterized by their own pros and cons. This contribution discusses types of indicators and how to choose between indicators for as specific case. In addition, it explains that information and communication technology (ICT) increasingly plays a dominant role in people’s life as far as (travel to) activities are concerned, and consequently the importance of ICT for accessibility analyses also increases. Finally, it presents several challenges for future research.;,citation_author=Bert Wee;,citation_editor=Roger Vickerman;,citation_publication_date=2021-01;,citation_cover_date=2021-01;,citation_year=2021;,citation_doi=10.1016/B978-0-08-102671-7.10402-6;,citation_isbn=978-0-08-102672-4;,citation_language=en-US;,citation_inbook_title=International Encyclopedia of Transportation;">
<meta name="citation_reference" content="citation_title=Accessibility and equity: A conceptual framework and research agenda;,citation_author=Bert Wee;,citation_publication_date=2022-10;,citation_cover_date=2022-10;,citation_year=2022;,citation_doi=10.1016/j.jtrangeo.2022.103421;,citation_issn=09666923;,citation_volume=104;,citation_language=en-US;,citation_journal_title=Journal of Transport Geography;">
<meta name="citation_reference" content="citation_title=Urban transport policies in Brazil: The creation of a discriminatory mobility system;,citation_author=Eduardo Alcantara Vasconcellos;,citation_publication_date=2018-02;,citation_cover_date=2018-02;,citation_year=2018;,citation_doi=10.1016/j.jtrangeo.2017.08.014;,citation_issn=0966-6923;,citation_volume=67;,citation_language=en-US;,citation_journal_title=Journal of Transport Geography;">
<meta name="citation_reference" content="citation_title=Assessing the potential of bus rapid transit-led network restructuring for enhancing affordable access to employment  The case of Johannesburg’s Corridors of Freedom;,citation_author=Christoffel Venter;,citation_publication_date=2016-11;,citation_cover_date=2016-11;,citation_year=2016;,citation_doi=10.1016/j.retrec.2016.05.006;,citation_issn=07398859;,citation_volume=59;,citation_language=en-US;,citation_journal_title=Research in Transportation Economics;">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb">
<li class="breadcrumb-item"><a href="./s3_dados_tp.en.html">SECTION 3: Public transport data</a></li>
<li class="breadcrumb-item"><a href="./4_dados_gtfs.en.html"><span class="chapter-number">4</span>  <span class="chapter-title">GTFS data</span></a></li>
</ol></nav><a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to urban accessibility</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://repositorio.ipea.gov.br/bitstream/11058/12689/52/Introduction_urban_accessibility_Book.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-download"></i></a>
    <a href="https://github.com/ipeaGIT/intro_access_book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./s1_intro.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SECTION 1: Introduction to urban accessibility</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_conceito.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>  <span class="chapter-title">What is accessibility?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_indicadores.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>  <span class="chapter-title">Accessibility measures</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./s2_calculo.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SECTION 2: How to measure urban accessibility</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_calculando_acesso.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>  <span class="chapter-title">Calculating accessibility estimates in R</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./s3_dados_tp.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SECTION 3: Public transport data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_dados_gtfs.en.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>  <span class="chapter-title">GTFS data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_gtfstools.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>  <span class="chapter-title">GTFS data manipulation and visualization</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./s4_avaliacao_impacto.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SECTION 4: Impact assessment of transportation projects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_cenarios_transporte.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>  <span class="chapter-title">Comparing accessibility between two transport scenarios</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./s5_dados_aop.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SECTION 5: Data from the Access to Opportunity Project</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7_aopdata_populacao.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>  <span class="chapter-title">Population and socioeconomic data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8_aopdata_uso_solo.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>  <span class="chapter-title">Data on the spatial distribution of opportunities</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9_aopdata_acessibilidade.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>  <span class="chapter-title">Accessibility estimates</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#gtfs-structure" id="toc-gtfs-structure" class="nav-link active" data-scroll-target="#gtfs-structure"><span class="header-section-number">4.1</span> GTFS structure</a>
  <ul class="collapse">
<li><a href="#agency.txt" id="toc-agency.txt" class="nav-link" data-scroll-target="#agency.txt"><span class="header-section-number">4.1.1</span> agency.txt</a></li>
  <li><a href="#stops.txt" id="toc-stops.txt" class="nav-link" data-scroll-target="#stops.txt"><span class="header-section-number">4.1.2</span> stops.txt</a></li>
  <li><a href="#routes.txt" id="toc-routes.txt" class="nav-link" data-scroll-target="#routes.txt"><span class="header-section-number">4.1.3</span> routes.txt</a></li>
  <li><a href="#trips.txt" id="toc-trips.txt" class="nav-link" data-scroll-target="#trips.txt"><span class="header-section-number">4.1.4</span> trips.txt</a></li>
  <li><a href="#calendar.txt" id="toc-calendar.txt" class="nav-link" data-scroll-target="#calendar.txt"><span class="header-section-number">4.1.5</span> calendar.txt</a></li>
  <li><a href="#shapes.txt" id="toc-shapes.txt" class="nav-link" data-scroll-target="#shapes.txt"><span class="header-section-number">4.1.6</span> shapes.txt</a></li>
  <li><a href="#stop_times.txt" id="toc-stop_times.txt" class="nav-link" data-scroll-target="#stop_times.txt"><span class="header-section-number">4.1.7</span> stop_times.txt</a></li>
  <li><a href="#frequencies.txt" id="toc-frequencies.txt" class="nav-link" data-scroll-target="#frequencies.txt"><span class="header-section-number">4.1.8</span> frequencies.txt</a></li>
  </ul>
</li>
  <li><a href="#finding-gtfs-data-for-brazilian-cities" id="toc-finding-gtfs-data-for-brazilian-cities" class="nav-link" data-scroll-target="#finding-gtfs-data-for-brazilian-cities"><span class="header-section-number">4.2</span> Finding GTFS data for Brazilian cities</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ipeaGIT/intro_access_book/edit/main/4_dados_gtfs.en.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav><a href="pt/4_dados_gtfs.html">Leia em português</a>
</div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb">
<li class="breadcrumb-item"><a href="./s3_dados_tp.en.html">SECTION 3: Public transport data</a></li>
<li class="breadcrumb-item"><a href="./4_dados_gtfs.en.html"><span class="chapter-number">4</span>  <span class="chapter-title">GTFS data</span></a></li>
</ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">4</span>  <span class="chapter-title">GTFS data</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>The GTFS format is an open and collaborative specification that aims to describe the main components of a public transport network. Originally created in the mid-2000s by a partnership between Google and TriMet, the transport agency of Portland, Oregon, in the United States, the GTFS specification is now used by transport agencies in thousands of cities, spread across all continents of the globe <span class="citation" data-cites="mchugh2013pioneering">(<a href="references.en.html#ref-mchugh2013pioneering" role="doc-biblioref">McHugh 2013</a>)</span>. Currently, the specification is divided in two distinct components:</p>
<ul>
<li>The GTFS Schedule, or GTFS Static, which contains the planned schedule of public transport trips, information about their fares and spatial information about their itineraries; and</li>
<li>The GTFS Realtime, which is used to inform, in real-time, vehicle location information, alerts for possible delays, itinerary changes and events that may interfere with the planned schedule.</li>
</ul>
<p>Throughout this section, we will focus on <strong>GTFS Schedule</strong>, the most widely used GTFS format in accessibility analyses and by transport agencies<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>Being an open and collaborative specification, the GTFS format attempts to enable several distinct uses that transport agencies and tool developers might find for it. However, agencies and applications may still depend on information that is not included in the official specification. As a result, different specification <a href="https://gtfs.org/extensions/">extensions</a> have been created, and some of them may eventually be incorporated into the official specification if this is agreed upon by the GTFS community. In this section, we will focus on a subset of information available in the basic GTFS Schedule format, thus not covering its extensions.</p>
<section id="gtfs-structure" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="gtfs-structure">
<span class="header-section-number">4.1</span> GTFS structure</h2>
<p>Files in the GTFS Schedule format (from this point onwards referred to as GTFS) are also known as feeds<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. A feed is nothing more than a compressed <code>.zip</code> file that contains a set of tables, saved in separate <code>.txt</code> files, describing some aspects of the public transport network (stops/stations location, trip frequency, itineraries paths, etc). Just like in a relational database, tables in a feed have key columns that allow one to link information described in one table to the data described in another one. An example of the GTFS scheme is presented in <a href="#fig-scheme" class="quarto-xref">Figure <span>4.1</span></a>, which shows some of the the most important tables that make up the specification and highlights the key columns that link the tables together.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scheme" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-scheme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/gtfs_scheme.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scheme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 4.1: GTFS format scheme. Source: <span class="citation" data-cites="pereira2022exploringa">Pereira, Andrade, and Vieira (<a href="references.en.html#ref-pereira2022exploringa" role="doc-biblioref">2022</a>)</span>
</figcaption></figure>
</div>
</div>
</div>
<p>In total, the GTFS format can be made of up to 22 tables<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. Some of them, however, are optional, meaning that they don’t need to be present for the feed to be considered valid. The specification classifies the presence of a table into the following categories: required, optional and conditionally required (when the requirement of the table depends on the existence of another particular table, column or value). For simplicity, we will consider only the first two categories in this book and will indicate whether a table is required whenever appropriate. Using our simplified convention, tables are classified as follows:</p>
<ul>
<li>
<strong>Required</strong>: <code>agency.txt</code>; <code>stops.txt</code>; <code>routes.txt</code>; <code>trips.txt</code>; <code>stop_times.txt</code>; <code>calendar.txt</code>.</li>
<li>
<strong>Optional</strong>: <code>calendar_dates.txt</code>: <code>fare_attributes.txt</code>; <code>fare_rules.txt</code>; <code>fare_products.txt</code>; <code>fare_leg_rules.txt</code>; <code>fare_transfer_rules.txt</code>; <code>areas.txt</code>; <code>stop_areas.txt</code>; <code>shapes.txt</code>; <code>frequencies.txt</code>; <code>transfers.txt</code>; <code>pathways.txt</code>; <code>levels.txt</code>; <code>translations.txt</code>; <code>feed_info.txt</code>; <code>attributions.txt</code>.</li>
</ul>
<p>Throughout this chapter, we will learn about the basic structure of a GTFS file and its tables. We will focus only on the required tables and the optional tables most often used by producers and consumers of these files<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<p>In this demonstration, we use a subset of a feed describing the public transport network of São Paulo, Brazil, produced by São Paulo Transporte (SPTrans)<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> and downloaded in October 2019. The feed contains the six required tables plus two widely used optional tables, <code>shapes.txt</code> and <code>frequencies.txt</code>, which gives a good overview of the GTFS format.</p>
<section id="agency.txt" class="level3" data-number="4.1.1"><h3 data-number="4.1.1" class="anchored" data-anchor-id="agency.txt">
<span class="header-section-number">4.1.1</span> agency.txt</h3>
<p>File used to list the transport operators/agencies running the system described by the feed. Although the term agency, instead of operators, is used, it is up to the feed producer to choose which institutions are listed in the table.</p>
<p>For example, imagine that multiple bus companies operate in a given location, but all schedule and fare planning is carried out by a single institution, either a transport agency or a specific public entity, which is also recognized by public transport users as the system operator. In this case, we should probably list the planning institution in the table.</p>
<p>Now imagine a scenario in which a local public transport agency transfers the operation of a multimodal system to several companies (using concession contracts, for example). Each one of these companies is responsible for planning the schedules and fares of trips/routes they operate, provided that certain pre-established parameters are followed. In this case, we would probably be better off listing the operators in the table, instead of the public transport agency.</p>
<p><a href="#tbl-agency" class="quarto-xref">Table <span>4.1</span></a> shows the <code>agency.txt</code> file of SPTrans’ feed. We can see that the feed producers decided to list the company itself in the table, instead of the operators of buses and subway routes.</p>
<div class="cell">
<div id="tbl-agency" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-agency-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 4.1: <code>agency.txt</code> example. Source: SPTrans
</figcaption><div aria-describedby="tbl-agency-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 44%">
<col style="width: 19%">
<col style="width: 12%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">agency_id</th>
<th style="text-align: left;">agency_name</th>
<th style="text-align: left;">agency_url</th>
<th style="text-align: left;">agency_timezone</th>
<th style="text-align: left;">agency_lang</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">SPTRANS</td>
<td style="text-align: left;">http://www.sptrans.com.br/?versao=011019</td>
<td style="text-align: left;">America/Sao_Paulo</td>
<td style="text-align: left;">pt</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>It is important to note that, although we are presenting <code>agency.txt</code> in table format, the data should be formatted as a <code>.csv</code> file. That is, the values of each cell must be separated by commas, and the contents of each table row must be listed in a different row of the <code>.csv</code> file. The table above, for example, is formatted as follows:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>agency_id,agency_name,agency_url,agency_timezone,agency_lang
1,SPTRANS,http://www.sptrans.com.br/?versao=011019,America/Sao_Paulo,pt </code></pre>
</div>
</div>
<p>For the sake of communicability and interpretability, the next examples in this chapter are also presented as tables. It is important to keep in mind, however, that these tables are structured as shown above.</p>
</section><section id="stops.txt" class="level3" data-number="4.1.2"><h3 data-number="4.1.2" class="anchored" data-anchor-id="stops.txt">
<span class="header-section-number">4.1.2</span> stops.txt</h3>
<p>File used to describe the stops in a public transport system. The points listed in this file may reference simple stops (such as bus stops), stations, platforms, station entrances and exits, etc. <a href="#tbl-stops" class="quarto-xref">Table <span>4.2</span></a> shows the <code>stops.txt</code> of SPTrans’ feed.</p>
<div class="cell">
<div id="tbl-stops" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-stops-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 4.2: <code>stops.txt</code> example. Source: SPTrans
</figcaption><div aria-describedby="tbl-stops-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 16%">
<col style="width: 61%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">stop_id</th>
<th style="text-align: left;">stop_name</th>
<th style="text-align: left;">stop_desc</th>
<th style="text-align: right;">stop_lat</th>
<th style="text-align: right;">stop_lon</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">706325</td>
<td style="text-align: left;">Parada 14 Bis B/C</td>
<td style="text-align: left;">Viad. Dr. Plínio De Queiroz, 901</td>
<td style="text-align: right;">-23.55593</td>
<td style="text-align: right;">-46.65011</td>
</tr>
<tr class="even">
<td style="text-align: left;">810602</td>
<td style="text-align: left;">R. Sta. Rita, 56</td>
<td style="text-align: left;">Ref.: R. Bresser / R. João Boemer</td>
<td style="text-align: right;">-23.53337</td>
<td style="text-align: right;">-46.61229</td>
</tr>
<tr class="odd">
<td style="text-align: left;">910776</td>
<td style="text-align: left;">Av. Do Estado, 5854</td>
<td style="text-align: left;">Ref.: Rua Dona Ana Néri</td>
<td style="text-align: right;">-23.55896</td>
<td style="text-align: right;">-46.61520</td>
</tr>
<tr class="even">
<td style="text-align: left;">1010092</td>
<td style="text-align: left;">Parada Caetano Pinto</td>
<td style="text-align: left;">Av. Rangel Pestana, 1249 Ref.: Rua Caetano Pinto/rua Prof. Batista De Andrade</td>
<td style="text-align: right;">-23.54615</td>
<td style="text-align: right;">-46.62218</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1010093</td>
<td style="text-align: left;">Parada Piratininga</td>
<td style="text-align: left;">Av. Rangel Pestana, 1479 Ref.: Rua Monsenhor Andrade</td>
<td style="text-align: right;">-23.54509</td>
<td style="text-align: right;">-46.62006</td>
</tr>
<tr class="even">
<td style="text-align: left;">1010099</td>
<td style="text-align: left;">R. Xavantes, 612</td>
<td style="text-align: left;">Ref.: Rua Joli</td>
<td style="text-align: right;">-23.53545</td>
<td style="text-align: right;">-46.61368</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The columns <code>stop_id</code> and <code>stop_name</code> identify each stop, but fulfill different roles. The purpose of <code>stop_id</code> is to identify relationships between this table and other tables that compose the feed (as we will later see in the <code>stop_times.txt</code> file, for example). Meanwhile, the column <code>stop_name</code> serves as an identifier that should be easily recognized by the passengers, thus usually assuming values of station names, points of interest or addresses (as in the case of SPTrans’ feed).</p>
<p>The <code>stop_desc</code> column, present in SPTrans’ feed, is optional and allows feed producers to add a description of each stop and its surroundings. Finally, <code>stop_lat</code> and <code>stop_lon</code> associate each stop to a point in space with its latitude and longitude geographic coordinates.</p>
<p>Two of the optional columns not present in this <code>stops.txt</code> table are <code>location_type</code> and <code>parent_station</code>. The <code>location_type</code> column is used to indicate the type of location that each point refers to. When not explicitly set, all points are interpreted as public transport stops, but distinct values can be used to distinguish a stop (<code>location_type = 0</code>) from a station (<code>location_type = 1</code>) or a boarding area (<code>location_type = 2</code>), for example. The <code>parent_station</code> column, on the other hand, is used to describe hierarchical relationships between two points. When describing a boarding area, for example, the feed producer must list the stop/platform that this area refers to, and when describing a stop/platform the producer can optionally list the station that it belongs to.</p>
</section><section id="routes.txt" class="level3" data-number="4.1.3"><h3 data-number="4.1.3" class="anchored" data-anchor-id="routes.txt">
<span class="header-section-number">4.1.3</span> routes.txt</h3>
<p>File used to describe the routes that run in a public transport system. <a href="#tbl-routes" class="quarto-xref">Table <span>4.3</span></a> shows the <code>routes.txt</code> of SPTrans’ feed.</p>
<div class="cell">
<div id="tbl-routes" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-routes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 4.3: <code>routes.txt</code> example. Source: SPTrans
</figcaption><div aria-describedby="tbl-routes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 22%">
<col style="width: 38%">
<col style="width: 14%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">route_id</th>
<th style="text-align: left;">agency_id</th>
<th style="text-align: left;">route_short_name</th>
<th style="text-align: left;">route_long_name</th>
<th style="text-align: right;">route_type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CPTM L07</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">CPTM L07</td>
<td style="text-align: left;">JUNDIAI - LUZ</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">CPTM L08</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">CPTM L08</td>
<td style="text-align: left;">AMADOR BUENO - JULIO PRESTES</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPTM L09</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">CPTM L09</td>
<td style="text-align: left;">GRAJAU - OSASCO</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">CPTM L10</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">CPTM L10</td>
<td style="text-align: left;">RIO GRANDE DA SERRA - BRÁS</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPTM L11</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">CPTM L11</td>
<td style="text-align: left;">ESTUDANTES - LUZ</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">CPTM L12</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">CPTM L12</td>
<td style="text-align: left;">CALMON VIANA - BRAS</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>As in the case of <code>stops.txt</code>, the <code>routes.txt</code> table also includes different columns to distinguish between the identifier of each route (<code>route_id</code>) and their names. In this case, however, there are two distinct name columns: <code>route_short_name</code> and <code>route_long_name</code>. The first refers to the name of the route commonly recognized by passengers, while the second tends to be a more descriptive name. SPTrans, for example, has chosen to highlight the start and endpoints of each route in the latter column. We can also note that the same values are repeated in both <code>route_id</code> and <code>route_short_name</code>, which is neither required nor forbidden - in this case, the feed producer decided that the route names could satisfactorily work as identifiers because they are reasonably short and unique.</p>
<p>The <code>agency_id</code> column works as the key column that links the routes to the data described in <code>agency.txt</code>, and it indicates the agency responsible for operating each route - in this case the agency with id <code>1</code> (SPTrans itself). This column is optional in the case of feeds containing a single agency, but required otherwise. Using a feed describing a multimodal system with a subway corridor and several bus lines as an example, a possible configuration of <code>routes.txt</code> could associate the subway routes to the subway operator and the bus routes to the agency/company responsible for planning the bus schedules.</p>
<p>The <code>route_type</code> column is used to describe the transport mode of each route. The above example lists rail lines, whose corresponding numeric value is <code>2</code>. The corresponding values of other transport modes are listed in the <a href="https://gtfs.org/schedule/reference/#routestxt">specification</a>.</p>
</section><section id="trips.txt" class="level3" data-number="4.1.4"><h3 data-number="4.1.4" class="anchored" data-anchor-id="trips.txt">
<span class="header-section-number">4.1.4</span> trips.txt</h3>
<p>File used to describe the trips that compose the system. The trip is the basic unit of movement in the GTFS format: each trip is associated with a public transport route (<code>route_id</code>), with a service that operates on certain days of the week (as we will later cover in <code>calendar.txt</code>) and with a spatial trajectory (as we will later cover in <code>shapes.txt</code>). <a href="#tbl-trips" class="quarto-xref">Table <span>4.4</span></a> shows the <code>trips.txt</code> of SPTrans’ feed.</p>
<div class="cell">
<div id="tbl-trips" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-trips-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 4.4: <code>trips.txt</code> example. Source: SPTrans
</figcaption><div aria-describedby="tbl-trips-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 16%">
<col style="width: 20%">
<col style="width: 19%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">trip_id</th>
<th style="text-align: left;">route_id</th>
<th style="text-align: left;">service_id</th>
<th style="text-align: left;">trip_headsign</th>
<th style="text-align: right;">direction_id</th>
<th style="text-align: left;">shape_id</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CPTM L07-0</td>
<td style="text-align: left;">CPTM L07</td>
<td style="text-align: left;">USD</td>
<td style="text-align: left;">JUNDIAI</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">17846</td>
</tr>
<tr class="even">
<td style="text-align: left;">CPTM L07-1</td>
<td style="text-align: left;">CPTM L07</td>
<td style="text-align: left;">USD</td>
<td style="text-align: left;">LUZ</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17847</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPTM L08-0</td>
<td style="text-align: left;">CPTM L08</td>
<td style="text-align: left;">USD</td>
<td style="text-align: left;">AMADOR BUENO</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">17848</td>
</tr>
<tr class="even">
<td style="text-align: left;">CPTM L08-1</td>
<td style="text-align: left;">CPTM L08</td>
<td style="text-align: left;">USD</td>
<td style="text-align: left;">JULIO PRESTES</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17849</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPTM L09-0</td>
<td style="text-align: left;">CPTM L09</td>
<td style="text-align: left;">USD</td>
<td style="text-align: left;">GRAJAU</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">17850</td>
</tr>
<tr class="even">
<td style="text-align: left;">CPTM L09-1</td>
<td style="text-align: left;">CPTM L09</td>
<td style="text-align: left;">USD</td>
<td style="text-align: left;">OSASCO</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">17851</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The <code>trip_id</code> column identifies the trips described in the table, just as the <code>route_id</code> references a route described in <code>routes.txt</code>. The <code>service_id</code> column identifies the services that determine the days of the week that each trip runs on (weekdays, weekends, a mix of both, etc), described in detail in <code>calendar.txt</code>. The rightmost column in the example above is <code>shape_id</code>, which identifies the spatial trajectory of each trip, described in detail in the <code>shapes.txt</code> file.</p>
<p>The two remaining columns, <code>trip_headsign</code> and <code>direction_id</code>, are optional and should be used to describe the direction/destination of the trip. The first, <code>trip_headsign</code>, is used to report the text that appears on the vehicle headsign (in the case of buses, for example) or on information panels (such as in subway and rail stations) highlighting the destination of the trip. The <code>direction_id</code> column is often used in conjunction with <code>trip_headsign</code> to distinguish the direction of each trip, where <code>0</code> represents one direction and <code>1</code> the opposite one. In our example, the first two rows describe trips that refer to the same public transport route (<code>CPTM L07</code>), but in opposite directions: one runs towards Jundiaí, and the other towards Luz.</p>
</section><section id="calendar.txt" class="level3" data-number="4.1.5"><h3 data-number="4.1.5" class="anchored" data-anchor-id="calendar.txt">
<span class="header-section-number">4.1.5</span> calendar.txt</h3>
<p>File used to describe the different service calendars in a public transport system, listing the set of days of the week in which trips may occur. Each service is also associated to an interval, with a start and an end date, within which the service operates. <a href="#tbl-calendar" class="quarto-xref">Table <span>4.5</span></a> shows the <code>calendar.txt</code> of SPTrans’ feed.</p>
<div class="cell">
<div id="tbl-calendar" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-calendar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 4.5: <code>calendar.txt</code> example. Source: SPTrans
</figcaption><div aria-describedby="tbl-calendar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">service_id</th>
<th style="text-align: right;">monday</th>
<th style="text-align: right;">tuesday</th>
<th style="text-align: right;">wednesday</th>
<th style="text-align: right;">thursday</th>
<th style="text-align: right;">friday</th>
<th style="text-align: right;">saturday</th>
<th style="text-align: right;">sunday</th>
<th style="text-align: right;">start_date</th>
<th style="text-align: right;">end_date</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">USD</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20080101</td>
<td style="text-align: right;">20200501</td>
</tr>
<tr class="even">
<td style="text-align: left;">U__</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20080101</td>
<td style="text-align: right;">20200501</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US_</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20080101</td>
<td style="text-align: right;">20200501</td>
</tr>
<tr class="even">
<td style="text-align: left;">_SD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20080101</td>
<td style="text-align: right;">20200501</td>
</tr>
<tr class="odd">
<td style="text-align: left;">__D</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20080101</td>
<td style="text-align: right;">20200501</td>
</tr>
<tr class="even">
<td style="text-align: left;">_S_</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20080101</td>
<td style="text-align: right;">20200501</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The column <code>service_id</code> identifies each service described in the table. As shown earlier, this identifier is also used in the <code>trips.txt</code>, where it associates each trip to a particular service.</p>
<p>The <code>monday</code>, <code>tuesday</code>, <code>wednesday</code>, <code>thursday</code>, <code>friday</code>, <code>saturday</code> and <code>sunday</code> columns are used to list the days of the week in which each service operates. A value of <code>1</code> means that the service operates on that day, while a value of <code>0</code> means that it does not. In the example above, the <code>USD</code> service operates on every day of the week and the service <code>U__</code> operates only on business days.</p>
<p>Finally, the columns <code>start_date</code> and <code>end_date</code> delimit the interval within which the services are valid. Dates in GTFS files must always be formatted using the <code>YYYYMMDD</code> format: the first four numbers define the year, the subsequent two define the month and the last two, the day. The value <code>20220428</code>, for example, represents the 28th of April 2022.</p>
</section><section id="shapes.txt" class="level3" data-number="4.1.6"><h3 data-number="4.1.6" class="anchored" data-anchor-id="shapes.txt">
<span class="header-section-number">4.1.6</span> shapes.txt</h3>
<p>File used to describe the spatial trajectory of each trip in the system. This file is optional, but feed producers are strongly encouraged to include it in their GTFS files. <a href="#tbl-shapes" class="quarto-xref">Table <span>4.6</span></a> shows the <code>shapes.txt</code> of SPTrans’ feed.</p>
<div class="cell">
<div id="tbl-shapes" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-shapes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 4.6: <code>shapes.txt</code> example. Source: SPTrans
</figcaption><div aria-describedby="tbl-shapes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">shape_id</th>
<th style="text-align: right;">shape_pt_lat</th>
<th style="text-align: right;">shape_pt_lon</th>
<th style="text-align: right;">shape_pt_sequence</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">17846</td>
<td style="text-align: right;">-23.53517</td>
<td style="text-align: right;">-46.63535</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">17846</td>
<td style="text-align: right;">-23.53513</td>
<td style="text-align: right;">-46.63548</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">17846</td>
<td style="text-align: right;">-23.53494</td>
<td style="text-align: right;">-46.63626</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">17846</td>
<td style="text-align: right;">-23.53473</td>
<td style="text-align: right;">-46.63710</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">17846</td>
<td style="text-align: right;">-23.53466</td>
<td style="text-align: right;">-46.63735</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">17846</td>
<td style="text-align: right;">-23.53416</td>
<td style="text-align: right;">-46.63866</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The column <code>shape_id</code> identifies each shape and links each trip to its spatial trajectory in the <code>trips.txt</code> table. Unlike all the other identifiers we have seen so far, however, <code>shape_id</code> is repeated in several table rows. This is because each shape is defined by a sequence of spatial points, whose geographic coordinates are described with the <code>shape_pt_lat</code> and <code>shape_pt_lon</code> columns. The <code>shape_pt_sequence</code> column lists the sequence in which the points connect to form the shape. Values listed in this column must increase along the path.</p>
</section><section id="stop_times.txt" class="level3" data-number="4.1.7"><h3 data-number="4.1.7" class="anchored" data-anchor-id="stop_times.txt">
<span class="header-section-number">4.1.7</span> stop_times.txt</h3>
<p>File used to describe the timetable of each trip, including the arrival and departure times at each stop. How this table should be formatted depends on whether the feed contains a <code>frequencies.txt</code> table or not, a detail that we will cover later. For now, we will look at the <code>stop_times.txt</code> of SPTrans’ feed, which also includes a <code>frequencies.txt</code>, in <a href="#tbl-stop_times" class="quarto-xref">Table <span>4.7</span></a>.</p>
<div class="cell">
<div id="tbl-stop_times" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-stop_times-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 4.7: <code>stop_times.txt</code> example. Source: SPTrans
</figcaption><div aria-describedby="tbl-stop_times-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">trip_id</th>
<th style="text-align: left;">arrival_time</th>
<th style="text-align: left;">departure_time</th>
<th style="text-align: left;">stop_id</th>
<th style="text-align: right;">stop_sequence</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CPTM L07-0</td>
<td style="text-align: left;">04:00:00</td>
<td style="text-align: left;">04:00:00</td>
<td style="text-align: left;">18940</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">CPTM L07-0</td>
<td style="text-align: left;">04:08:00</td>
<td style="text-align: left;">04:08:00</td>
<td style="text-align: left;">18920</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPTM L07-0</td>
<td style="text-align: left;">04:16:00</td>
<td style="text-align: left;">04:16:00</td>
<td style="text-align: left;">18919</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">CPTM L07-0</td>
<td style="text-align: left;">04:24:00</td>
<td style="text-align: left;">04:24:00</td>
<td style="text-align: left;">18917</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPTM L07-0</td>
<td style="text-align: left;">04:32:00</td>
<td style="text-align: left;">04:32:00</td>
<td style="text-align: left;">18916</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">CPTM L07-0</td>
<td style="text-align: left;">04:40:00</td>
<td style="text-align: left;">04:40:00</td>
<td style="text-align: left;">18965</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The trip whose timetable is being described is identified by the <code>trip_id</code> column. Similarly to what happens in <code>shapes.txt</code>, the same <code>trip_id</code> appears in several rows. This is because, just like a trip trajectory is composed of a sequence of spatial points, a timetable consists of a sequence of departure/arrival times at various public transport stops.</p>
<p>The next columns, <code>arrival_time</code>, <code>departure_time</code> and <code>stop_id</code>, describe the schedule of each trip, associating an arrival and a departure time to each visited stop. The time columns must be formatted using the <code>HH:MM:SS</code> format, with the first two numbers defining the hour, the subsequent two the minutes and the last two, the seconds. This format also accepts hour values greater than <code>24</code>: for example, if a trip departs at 11 pm but it only arrives at a given station at 1 am of the next day, the arrival time must be listed as <code>25:00:00</code>, not <code>01:00:00</code>. The <code>stop_id</code> column associates the arrival and departure times with a stop described in <code>stops.txt</code> and the <code>stop_sequence</code> column lists the sequence in which the stops connect to form the trip schedule. The values of this last column must always increase along the trip.</p>
<p>It is worth highlighting here the difference between <code>shapes.txt</code> and <code>stop_times.txt</code>. Although both tables present some spatial information of the trips, they do it in different ways. The <code>stop_times.txt</code> table lists the sequence of stops and times that make up a schedule, but says nothing about the trajectory traveled between the stops. <code>shapes.txt</code>, on the other hand, describes the detailed trajectory of a trip, but does not specify where the public transport stops are located. Combined, the information from the two tables allows one to understand both the schedule of each trip and the spatial trajectory between stops.</p>
</section><section id="frequencies.txt" class="level3" data-number="4.1.8"><h3 data-number="4.1.8" class="anchored" data-anchor-id="frequencies.txt">
<span class="header-section-number">4.1.8</span> frequencies.txt</h3>
<p>Optional file used to describe the frequency of each trip within different time intervals of a day. <a href="#tbl-frequencies" class="quarto-xref">Table <span>4.8</span></a> shows the <code>frequency.txt</code> of SPTrans’ feed.</p>
<div class="cell">
<div id="tbl-frequencies" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-frequencies-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 4.8: <code>frequencies.txt</code> example. Source: SPTrans
</figcaption><div aria-describedby="tbl-frequencies-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">trip_id</th>
<th style="text-align: left;">start_time</th>
<th style="text-align: left;">end_time</th>
<th style="text-align: right;">headway_secs</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CPTM L07-0</td>
<td style="text-align: left;">04:00:00</td>
<td style="text-align: left;">04:59:00</td>
<td style="text-align: right;">720</td>
</tr>
<tr class="even">
<td style="text-align: left;">CPTM L07-0</td>
<td style="text-align: left;">05:00:00</td>
<td style="text-align: left;">05:59:00</td>
<td style="text-align: right;">360</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPTM L07-0</td>
<td style="text-align: left;">06:00:00</td>
<td style="text-align: left;">06:59:00</td>
<td style="text-align: right;">360</td>
</tr>
<tr class="even">
<td style="text-align: left;">CPTM L07-0</td>
<td style="text-align: left;">07:00:00</td>
<td style="text-align: left;">07:59:00</td>
<td style="text-align: right;">360</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPTM L07-0</td>
<td style="text-align: left;">08:00:00</td>
<td style="text-align: left;">08:59:00</td>
<td style="text-align: right;">360</td>
</tr>
<tr class="even">
<td style="text-align: left;">CPTM L07-0</td>
<td style="text-align: left;">09:00:00</td>
<td style="text-align: left;">09:59:00</td>
<td style="text-align: right;">480</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The trip whose frequency is being described is identified by the <code>trip_id</code> column. Again, the same identifier may appear in multiple observations. This is because the specification allows the same trip to have different frequencies throughout the day, such as at peak and off-peak hours, for example. Thus, each row refers to the frequency of a given trip within the time interval specified by the <code>start_time</code> and <code>end_time</code> columns.</p>
<p>Within this interval, the trip operates on regular headways specified in <code>headway_secs</code>. The headway is the time between trips that operate the same route. In the case of this table, this time must be specified in seconds. In the example above, we see a headway of <code>720</code> between 4 and 5 am, which indicates that the <code>CPTM L07-0</code> trip departs every 12 minutes within this interval.</p>
<p><strong>Using <code>frequencies.txt</code> and <code>stop_times.txt</code> together</strong></p>
<p>It is important to understand how the presence of a <code>frequencies.txt</code> table changes the specification of <code>stop_times.txt</code>. As we can see in the <code>stop_times.txt</code> example, the <code>CPTM L07-0</code> trip departs from the first stop at 4 am and arrives at the second at 4:08 am. The arrival and departure times at a given stop, however, cannot be specified more than once for each trip, even though the headway set in <code>frequencies.txt</code> defines that this trip departs every 12 minutes from 4 am to 5 am. If that’s the case, how can we set the schedule of trips departing at 4:12 am, 4:24 am, 4:36 am, etc?</p>
<p>If the frequency of a trip is specified in <code>frequencies.txt</code>, the timetable of this trip defined in <code>stop_times.txt</code> should be understood as a reference that describes the time between stops. In other words, the times defined in the <code>stop_times.txt</code> file should not be interpreted “as is”. For example, the timetable of trip <code>CPTM L07-0</code> establishes that the journey between the first and second stop takes 8 minutes to complete, which is the same travel time between the second and third stops as well. Thus, a trip departing from the first stop at 4 am arrives at the second at 4:08 am and at the third at 4:16 am. The next trip, which departs from the first stop at 4:12 am, arrives at the second stop at 4:20 am and at the third at 4:28 am.</p>
<p>To describe the same trips in <code>stop_times.txt</code> without making a <code>frequencies.txt</code> table, one could add a suffix that would identify each trip of route <code>CPTM L07</code> in direction <code>0</code> throughout the day. The trip with id <code>CPTM L07-0_1</code>, for example, would be the first trip of the day heading towards direction <code>0</code> and would depart from the first stop at 4 am and arrive at the second at 4:08 am. The <code>CPTM L07-0_2</code> trip, on the other hand, would be the second trip of the day and would depart from the first stop at 04:12 am and arrive at the second at 4:20 am. The rest of the trips would follow the same pattern. Each one of these trips would also need to be added to <code>trips.txt</code>, as well as to any other tables that use <code>trip_id</code>.</p>
<p>Another variable that changes how <code>frequencies.txt</code> affects the timetables in <code>stop_times.txt</code> is the optional column <code>exact_times</code>. When it assumes the value of <code>0</code> (or when it is missing from the feed, as in the case of the SPTrans’ GTFS file) it indicates that the trip does not necessarily follow a fixed schedule over the time interval. Instead, operators try to maintain a predetermined headway during the interval. Using the same example of a trip whose headway is 12 minutes between 4 am and 5 am, this would mean that the first departure does not necessarily happen at 4 am, the second at 4:12 am, and so on. The first trip can, for example, leave at 4:02 am. The second, at 4:14 am or 4:13 am, etc. Meanwhile, an <code>exact_times</code> value of <code>1</code> must be used to define a schedule that always follows the exact same headway. This is an equivalent and more concise way of defining several similar trips departing at different times in <code>stop_times.txt</code> (as shown in the previous paragraph).</p>
</section></section><section id="finding-gtfs-data-for-brazilian-cities" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="finding-gtfs-data-for-brazilian-cities">
<span class="header-section-number">4.2</span> Finding GTFS data for Brazilian cities</h2>
<p>GTFS data from cities all over the world can be downloaded with the <a href="https://r-transit.github.io/tidytransit/"><code>{tidytransit}</code></a> R package or on the <a href="https://www.transit.land/">Transitland</a> website. In Brazil, several cities use GTFS data to plan and operate their transport systems. In many cases, however, the data is owned by private companies and operators and is not publicly available. As a result, GTFS data in Brazil is seldom openly available, which goes against the public interest and against good practices of data management and governance. <a href="#tbl-gtfs_brazil" class="quarto-xref">Table <span>4.9</span></a> lists some of the few Brazilian cities that make their GTFS feeds openly available to the public<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>.</p>
<div class="cell">
<div id="tbl-gtfs_brazil" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-gtfs_brazil-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 4.9: Openly available GTFS data in Brazil
</figcaption><div aria-describedby="tbl-gtfs_brazil-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">City</th>
<th style="text-align: left;">Source</th>
<th style="text-align: left;">Info</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Belo Horizonte</td>
<td style="text-align: left;">Belo Horizonte’s Transport and Traffic Company (BHTrans)</td>
<td style="text-align: left;">Open data: <a href="https://dados.pbh.gov.br/dataset/gtfs-estatico-do-sistema-convencional">conventional transport network</a> and <a href="https://dados.pbh.gov.br/dataset/feed-gtfs-estatico-do-sistema-suplementar">supplementary network</a>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fortaleza</td>
<td style="text-align: left;">Fortaleza’s Urban Transport Company (Etufor)</td>
<td style="text-align: left;">
<a href="https://dados.fortaleza.ce.gov.br/dataset/gtfs">Open data</a>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fortaleza</td>
<td style="text-align: left;">Fortaleza’s Subway (Metrofor)</td>
<td style="text-align: left;">
<a href="https://www.metrofor.ce.gov.br/gtfs/">Open data</a>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Porto Alegre</td>
<td style="text-align: left;">Porto Alegre’s Transport and Traffic Public Company (EPTC)</td>
<td style="text-align: left;">
<a href="https://dados.portoalegre.rs.gov.br/dataset/gtfs">Open data</a>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rio de Janeiro</td>
<td style="text-align: left;">Municipal Department of Transport (SMTR)</td>
<td style="text-align: left;">
<a href="https://www.data.rio/datasets/gtfs-do-rio-de-janeiro/about">Open data</a>.</td>
</tr>
<tr class="even">
<td style="text-align: left;">São Paulo</td>
<td style="text-align: left;">São Paulo’s Metropolitan Urban Transport Company (EMTU)</td>
<td style="text-align: left;">
<a href="https://www.emtu.sp.gov.br/emtu/dados-abertos/dados-abertos-principal/gtfs.fss">Download link</a>. Registration required.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">São Paulo</td>
<td style="text-align: left;">SPTrans</td>
<td style="text-align: left;">
<a href="https://www.sptrans.com.br/desenvolvedores/">Download link</a>. Registration required.</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Note: The GTFS data provided by SMTR does not include train and subway data.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-mchugh2013pioneering" class="csl-entry" role="listitem">
McHugh, Bibiana. 2013. <span>“Pioneering <span>Open Data Standards</span>: <span>The GTFS Story</span>.”</span> In <em>Beyond <span>Transparency</span>: <span>Open Data</span> and the <span>Future</span> of <span>Civic Innovation</span></em>, edited by Brett Goldstein and Lauren Dyson, First, 125–35. <span>San Francisco, CA</span>: <span>Code for America Press</span>.
</div>
<div id="ref-pereira2022exploringa" class="csl-entry" role="listitem">
Pereira, Rafael H. M., Pedro R. Andrade, and João Pedro Bazzo Vieira. 2022. <span>“Exploring the Time Geography of Public Transport Networks with the Gtfs2gps Package.”</span> <em>Journal of Geographical Systems</em>, December. <a href="https://doi.org/10.1007/s10109-022-00400-x">https://doi.org/10.1007/s10109-022-00400-x</a>.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Please visit <a href="https://gtfs.org/realtime/" class="uri">https://gtfs.org/realtime/</a> for more information on GTFS Realtime.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>In this book, we will use the terms feed, GTFS file and GTFS data as synonyms.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>According to the <a href="https://gtfs.org/schedule/reference/">official specification</a> as of May 9th 2022.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>For more information on the tables and columns not covered in this section, please check the <a href="https://gtfs.org/schedule/reference/">official specification</a>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Available at <a href="https://www.sptrans.com.br/desenvolvedores/" class="uri">https://www.sptrans.com.br/desenvolvedores/</a>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>As of the publication date of this book.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ipeagit\.github\.io\/intro_access_book");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./s3_dados_tp.en.html" class="pagination-link" aria-label="SECTION 3: Public transport data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">SECTION 3: Public transport data</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./5_gtfstools.en.html" class="pagination-link" aria-label="GTFS data manipulation and visualization">
        <span class="nav-page-text"><span class="chapter-number">5</span>  <span class="chapter-title">GTFS data manipulation and visualization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2023, Ipea - Instituto de Pesquisa Econômica Aplicada</p>
</div>   
    <div class="nav-footer-center">
       
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ipeaGIT/intro_access_book/edit/main/4_dados_gtfs.en.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/ipeaGIT/intro_access_book" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>
</body>
</html>
